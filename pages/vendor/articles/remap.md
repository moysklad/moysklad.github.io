---
title: Доступ по токену к JSON API 1.2
tags: [api, vendor, webhook]
keywords:
summary:
sidebar: vendor_sidebar
permalink: /api/vendor/1.0/remap.html
folder: vendor
---
## Базовая информация

Токен для доступа к JSON API 1.2 передается вендору при активации приложения через Vendor API. Время жизни токена не ограничено.

Токен аннулируется при отключении приложения пользователем. На момент деактивации приложения через Vendor API токен уже нерабочий (аннулирован).

Токен при доступе к JSON API 1.2 следует передавать как [Bearer-токен](https://tools.ietf.org/html/rfc6750#section-2.1),
 а именно в виде заголовка HTTP-запроса:
 
 ```text
Authorization: Bearer <access_token>
 ```

Пример:

```text
Authorization: Bearer 6ab89be1ae6ff147755625ee8da948e42612233b
```

### Диаграмма последовательности предоставления доступа при подключении приложения

![useful image]({{site.url}}/images/vendor/diag_install.png)

### Диаграмма последовательности отзыва доступа при отключении приложения

![useful image]({{site.url}}/images/vendor/diag_install.png)


## Vendor API

Vendor API предназначено для взаимодействия Маркетплейса с системами вендоров касательно процессов, происходящих в 
рамках функционирования Маркетплейса.

На текущий момент Vendor API включает в себя следующие функции:

+ Активацию и деактивацию приложений на аккаунте
+ Получение контекста пользователя для iframe-приложений

Подробную справочную информацию по Vendor API можно посмотреть здесь [Vendor API](https://dev.moysklad.ru/doc/api/vendor/1.0/).

### Активация приложения на аккаунте

В общем виде процесс активации приложения выглядит так:

1. Пользователь МоегоСклада нажимает кнопку “Установить” приложение.
2. Маркетплейс делает HTTP PUT запрос на сервер вендора, в том числе передавая и токен доступа к JSON API (если в 
дескрипторе приложения таковой доступ запрашивается). При этом доступ по переданному токену уже работает.
3. Сервер вендора, в рамках допустимого тайм-аута, отвечает на запрос одним из статусов в теле ответа:
    + **Activating** - этот статус предназначен для асинхронной активации на стороне вендора (то есть если в рамках 
    допустимого тайм-аута обработки HTTP PUT запроса не получается активировать приложение - например, для активации 
    приложения требуется несколько минут). Далее вендор должен оповестить МойСклад через эндпоинт “Обратного вызова 
    изменения статуса приложения на аккаунте” о завершении активации приложения статусом **Activated** или о том, что 
    приложению требуется настройка статусом **SettingsRequired**.
    + **SettingsRequired** - таким статусом вендор сообщает МоемуСкладу, что приложению требуется настройка пользователем 
    (через iframe-часть приложения). После того, как пользователь настроит приложение, вендор должен оповестить 
    МойСклад через эндпоинт “Обратного вызова изменения статуса приложения на аккаунте” об активации приложения, 
    передав статус **Activated**.
    + **Activated** - этот статус означает, что приложение сразу полностью активировано и уже заработало.

#### Диаграмма деятельности активации приложения

![useful image]({{site.url}}/images/vendor/diag_activate.png)

### Деактивация приложения на аккаунте

Процесс деактивации приложения существенно проще процесса активации:

1. Пользователь МоегоСклада нажимает кнопку “Отключить” приложение.
2. Маркетплейс аннулирует доступ по токену (если таковой был выдан) и выполняет HTTP DELETE запрос к серверу вендора. 
То есть на момент получения вендором оповещения по деактивации доступ по токену уже не работает.

#### Диаграмма деятельности деактивации приложения

![useful image]({{site.url}}/images/vendor/diag_deactivate.png)
 
## Работа с вебхуками

Если ваше приложение может создать вебхук(-и) на аккаунте пользователя, то нужно иметь в виду следующее поведение.
Перед процессом удаления приложения, инициированного пользователем, или при приостановке приложения 
(если оно платное), МойСклад удалит все созданные приложением вебхуки. 